{"version":3,"sources":["../../../../components/ui/input.tsx","../../../../app/dashboard/contracts/page.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n","import { createClient } from \"@/lib/supabase/server\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\n\nexport default async function ContractsPage() {\n  const supabase = await createClient()\n  const { data: templates } = await supabase.from(\"contract_templates\").select(\"*\").order(\"created_at\", { ascending: false })\n  const { data: sellerSigned } = await supabase\n    .from(\"leads\")\n    .select(\"id,name,address,seller_contract_signed_url,seller_contract_status,updated_at\")\n    .eq(\"seller_contract_status\", \"completed\")\n    .order(\"updated_at\", { ascending: false })\n    .limit(50)\n  const { data: buyerSigned } = await supabase\n    .from(\"leads\")\n    .select(\"id,name,address,buyer_contract_signed_url,buyer_contract_status,updated_at,winning_buyer_id\")\n    .eq(\"buyer_contract_status\", \"completed\")\n    .order(\"updated_at\", { ascending: false })\n    .limit(50)\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-lg font-semibold text-foreground\">Contracts</h1>\n      <div className=\"mt-4\">\n        <form action=\"/api/contracts/templates\" method=\"post\" encType=\"multipart/form-data\" className=\"flex items-center gap-2\">\n          <Input name=\"file\" type=\"file\" accept=\".pdf,.docx,.txt\" />\n          <Input name=\"name\" placeholder=\"Template name\" />\n          <Input name=\"role\" placeholder=\"Role (seller|buyer)\" />\n          <Input name=\"state\" placeholder=\"State (optional)\" />\n          <Button type=\"submit\">Upload Template</Button>\n        </form>\n        <div className=\"mt-4\">\n          <form action=\"/api/contracts/docuseal/link\" method=\"post\" encType=\"multipart/form-data\" className=\"flex flex-wrap items-center gap-2\">\n            <select name=\"role\" defaultValue=\"seller\" className=\"rounded border border-border bg-background p-2 text-sm\">\n              <option value=\"seller\">Seller</option>\n              <option value=\"buyer\">Buyer</option>\n            </select>\n            <Input name=\"state\" placeholder=\"State (optional)\" />\n            <Input name=\"templateId\" placeholder=\"DocuSeal template id or URL (e.g. http://localhost:3010/d/...)\" />\n            <Button type=\"submit\" variant=\"outline\">Link DocuSeal</Button>\n          </form>\n          <form action=\"/api/send-contract\" method=\"post\" className=\"mt-3 flex flex-wrap items-center gap-2\">\n            <select name=\"role\" defaultValue=\"seller\" className=\"rounded border border-border bg-background p-2 text-sm\">\n              <option value=\"seller\">Send Seller Contract</option>\n              <option value=\"buyer\">Send Buyer Contract</option>\n            </select>\n            <Input name=\"leadId\" placeholder=\"Lead ID\" />\n            <Button type=\"submit\">Send Contract</Button>\n          </form>\n          <form action=\"/api/sign/ds/manual-complete\" method=\"post\" className=\"mt-3 flex flex-wrap items-center gap-2\">\n            <select name=\"role\" defaultValue=\"seller\" className=\"rounded border border-border bg-background p-2 text-sm\">\n              <option value=\"seller\">Mark Seller Completed</option>\n              <option value=\"buyer\">Mark Buyer Completed</option>\n            </select>\n            <Input name=\"leadId\" placeholder=\"Lead ID\" />\n            <Input name=\"signedUrl\" placeholder=\"Signed URL (optional)\" />\n            <Button type=\"submit\" variant=\"outline\">Mark Completed</Button>\n          </form>\n        </div>\n      </div>\n      <h2 className=\"mt-6 text-base font-semibold text-foreground\">Contract Templates</h2>\n      <div className=\"mt-2 grid grid-cols-1 gap-3 md:grid-cols-2\">\n        {(!templates || templates.length === 0) && (\n          <div className=\"rounded-lg border border-border bg-card p-4\">\n            <p className=\"text-sm text-muted-foreground\">No templates uploaded yet. You can still link a DocuSeal ID or URL using the form above.</p>\n          </div>\n        )}\n        {(templates || []).map((t: any) => (\n          <div key={t.id} className=\"rounded-lg border border-border bg-card p-4\">\n            <p className=\"font-medium text-foreground\">{t.name}</p>\n            <p className=\"text-sm text-muted-foreground\">Role: {t.role}</p>\n            <p className=\"text-sm text-muted-foreground\">State: {t.state || \"-\"}</p>\n            <p className=\"text-xs text-muted-foreground\">Path: {t.storage_path}</p>\n            <div className=\"mt-2 flex items-center gap-2\">\n              <form action=\"/api/contracts/docuseal/link\" method=\"post\" encType=\"multipart/form-data\" className=\"flex items-center gap-2\">\n                <input type=\"hidden\" name=\"role\" value={t.role} />\n                <input type=\"hidden\" name=\"state\" value={t.state || \"\"} />\n                <Input name=\"templateId\" placeholder=\"DocuSeal template id or URL\" defaultValue={t.docuseal_template_id || t.docuseal_direct_link || \"\"} />\n                <Button type=\"submit\" variant=\"outline\">Link DocuSeal</Button>\n              </form>\n              <form action=\"/api/contracts/templates/delete\" method=\"post\" className=\"flex items-center gap-2\">\n                <input type=\"hidden\" name=\"id\" value={t.id} />\n                <Button type=\"submit\" variant=\"destructive\">Delete</Button>\n              </form>\n              {t.docuseal_direct_link && (\n                <a className=\"inline-block text-primary underline\" href={t.docuseal_direct_link} target=\"_blank\" rel=\"noreferrer\">\n                  Open DocuSeal\n                </a>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n      <h2 className=\"mt-8 text-base font-semibold text-foreground\">Seller Signed</h2>\n      <div className=\"mt-2 grid grid-cols-1 gap-3 md:grid-cols-2\">\n        {(!sellerSigned || sellerSigned.length === 0) && (\n          <div className=\"rounded-lg border border-border bg-card p-4\">\n            <p className=\"text-sm text-muted-foreground\">No seller contracts completed yet.</p>\n          </div>\n        )}\n        {(sellerSigned || []).map((l: any) => (\n          <div key={l.id} className=\"rounded-lg border border-border bg-card p-4\">\n            <p className=\"font-medium text-foreground\">{l.name}</p>\n            <p className=\"text-sm text-muted-foreground\">{l.address}</p>\n            <p className=\"text-xs text-muted-foreground\">Status: {l.seller_contract_status}</p>\n            {l.seller_contract_signed_url && (\n              <a className=\"mt-2 inline-block text-primary underline\" href={l.seller_contract_signed_url} target=\"_blank\" rel=\"noreferrer\">\n                View Signed PDF\n              </a>\n            )}\n          </div>\n        ))}\n      </div>\n      <h2 className=\"mt-8 text-base font-semibold text-foreground\">Buyer Signed</h2>\n      <div className=\"mt-2 grid grid-cols-1 gap-3 md:grid-cols-2\">\n        {(!buyerSigned || buyerSigned.length === 0) && (\n          <div className=\"rounded-lg border border-border bg-card p-4\">\n            <p className=\"text-sm text-muted-foreground\">No buyer contracts completed yet.</p>\n          </div>\n        )}\n        {(buyerSigned || []).map((l: any) => (\n          <div key={l.id} className=\"rounded-lg border border-border bg-card p-4\">\n            <p className=\"font-medium text-foreground\">{l.name}</p>\n            <p className=\"text-sm text-muted-foreground\">{l.address}</p>\n            <p className=\"text-xs text-muted-foreground\">Status: {l.buyer_contract_status}</p>\n            {l.winning_buyer_id && <p className=\"text-xs text-muted-foreground\">Buyer: {l.winning_buyer_id}</p>}\n            {l.buyer_contract_signed_url && (\n              <a className=\"mt-2 inline-block text-primary underline\" href={l.buyer_contract_signed_url} target=\"_blank\" rel=\"noreferrer\">\n                View Signed PDF\n              </a>\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}