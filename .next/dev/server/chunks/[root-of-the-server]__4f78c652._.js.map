{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/hector/.openclaw/workspace/svc-agent/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\nimport { cookies } from \"next/headers\"\n\nexport async function createClient() {\n  const cookieStore = await cookies()\n\n  return createServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll()\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\n        } catch {\n          // Server Component - ignore\n        }\n      },\n    },\n  })\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,kJAAoF;QAC3G,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,4BAA4B;gBAC9B;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///Users/hector/.openclaw/workspace/svc-agent/app/api/dashboard/stats/route.ts"],"sourcesContent":["import { createClient } from \"@/lib/supabase/server\"\nimport { NextResponse } from \"next/server\"\n\nexport async function GET() {\n  try {\n    const supabase = await createClient()\n\n    // Get total leads count\n    const { count: totalLeads, error: countError } = await supabase\n      .from(\"leads\")\n      .select(\"*\", { count: \"exact\", head: true })\n\n    if (countError) {\n      console.error(\"Error fetching leads count:\", countError)\n      return NextResponse.json(\n        { error: \"Failed to fetch leads count\" },\n        { status: 500 }\n      )\n    }\n\n    // Get leads by conversation state\n    const { data: leads, error: leadsError } = await supabase\n      .from(\"leads\")\n      .select(\"conversation_state\")\n\n    if (leadsError) {\n      console.error(\"Error fetching leads:\", leadsError)\n      return NextResponse.json(\n        { error: \"Failed to fetch leads\" },\n        { status: 500 }\n      )\n    }\n\n    // Calculate service business metrics\n    // Map wholesaling states to service business concepts\n    const total = totalLeads || 0\n    \n    // Consider leads \"booked\" if they're in advanced states\n    const bookedStates = ['qualified', 'offer_made', 'offer_accepted', 'contract_sent', 'contract_signed', 'closed']\n    const appointmentsBooked = leads?.filter(l => bookedStates.includes(l.conversation_state)).length || 0\n    \n    // Calculate booking rate\n    const bookingRate = total > 0 ? Math.round((appointmentsBooked / total) * 100) : 0\n    \n    // Estimate potential revenue ($500 avg service value per booked lead)\n    const avgServiceValue = 500\n    const potentialRevenue = appointmentsBooked * avgServiceValue\n\n    return NextResponse.json({\n      total_leads: total,\n      appointments_booked: appointmentsBooked,\n      booking_rate: bookingRate,\n      potential_revenue: potentialRevenue\n    })\n  } catch (error) {\n    console.error(\"Dashboard stats error:\", error)\n    return NextResponse.json(\n      { error: \"Internal server error\" },\n      { status: 500 }\n    )\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,2IAAY;QAEnC,wBAAwB;QACxB,MAAM,EAAE,OAAO,UAAU,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,SACpD,IAAI,CAAC,SACL,MAAM,CAAC,KAAK;YAAE,OAAO;YAAS,MAAM;QAAK;QAE5C,IAAI,YAAY;YACd,QAAQ,KAAK,CAAC,+BAA+B;YAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA8B,GACvC;gBAAE,QAAQ;YAAI;QAElB;QAEA,kCAAkC;QAClC,MAAM,EAAE,MAAM,KAAK,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,SAC9C,IAAI,CAAC,SACL,MAAM,CAAC;QAEV,IAAI,YAAY;YACd,QAAQ,KAAK,CAAC,yBAAyB;YACvC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAwB,GACjC;gBAAE,QAAQ;YAAI;QAElB;QAEA,qCAAqC;QACrC,sDAAsD;QACtD,MAAM,QAAQ,cAAc;QAE5B,wDAAwD;QACxD,MAAM,eAAe;YAAC;YAAa;YAAc;YAAkB;YAAiB;YAAmB;SAAS;QAChH,MAAM,qBAAqB,OAAO,OAAO,CAAA,IAAK,aAAa,QAAQ,CAAC,EAAE,kBAAkB,GAAG,UAAU;QAErG,yBAAyB;QACzB,MAAM,cAAc,QAAQ,IAAI,KAAK,KAAK,CAAC,AAAC,qBAAqB,QAAS,OAAO;QAEjF,sEAAsE;QACtE,MAAM,kBAAkB;QACxB,MAAM,mBAAmB,qBAAqB;QAE9C,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,aAAa;YACb,qBAAqB;YACrB,cAAc;YACd,mBAAmB;QACrB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}